<!doctype html><html lang=en><head><title>Dotnet Build Tools</title><meta charset=utf-8><meta name=generator content="Hugo 0.109.0"><meta name=author content="Florian Winkelbauer"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://florianwinkelbauer.com/posts/2020-04-04-dotnet-build/><link rel=alternate type=application/rss+xml title=RSS href=https://florianwinkelbauer.com/index.xml><link rel=stylesheet href=https://florianwinkelbauer.com/main.css></head><body><header class=dark><h2><a href=https://florianwinkelbauer.com/>Florian Winkelbauer</a></h2><nav><a href=/about>About</a>
<a href=/notes>Notes</a>
<a href=/projects>Projects</a></nav></header><main><article><header><h1><a href=https://florianwinkelbauer.com/posts/2020-04-04-dotnet-build/>Dotnet Build Tools</a></h1><time datetime=2020-04-04T00:00:00Z>April 04, 2020</time></header><p>In the last five years, the dotnet build environment has grown so much. When I
started as a C# developer a few years ago, all my builds were done by hand.
Deploying an artifact meant to manually copy it onto the target machine. Since
then I have improved my process step by step.</p><h2 id=abusing-the-prepost-build-snippets>Abusing the Pre/Post Build Snippets</h2><p>A <code>csproj</code> file can contain pre- and post-build snippets. I have used this
feature to create an automated deployment when switching the build configuration
from &ldquo;Debug&rdquo; to &ldquo;Release&rdquo;. While this solution worked, I never felt at ease, as
I could run these snippets on accident when testing something in Visual Studio.</p><h2 id=custom-msbuild-scripts>Custom MSBuild Scripts</h2><p>MSBuild is a fully fledged build tool, which supports custom actions and even
comes with predefined commands to do various operations such as copying or
archiving files. The major downside is that MSBuild scripts, similar to Ant
scripts, are written in XML. While they work pretty fine, maintaining these
scripts is a pain.</p><h2 id=psake>Psake</h2><p>Several languages come with their own version of <code>make</code>. Psake is a build system
written in PowerShell. We still need to call MSBuild to compile a C# solution,
but we can leverage a pretty good shell to perform other tasks such as running a
linter, or archiving artifacts.</p><h2 id=cake>Cake</h2><p>Back when I found psake, the project did not have an active maintainer, which
meant that at one point I could not use it with newer versions of MSBuild and
Visual Studio. This lead me to Cake. Cake comes with a decent set of features
and can get even better with all the available addins which extend the feature
set even more. I even built my own addin for a version bumping CLI tool I used
to develop. While the development was rather straightforward, I started to ask
myself why if I am over-complicating things and why I don&rsquo;t just leverage CLI
tools without any wrapper code.</p><h2 id=back-to-psake>Back to Psake</h2><p>While switching most of my projects over from .NET Framework to .NET Core, I was
surprised how terrific the <code>dotnet</code> CLI is. Instead of downloading <code>nuget.exe</code>
to restore dependencies I can run <code>dotnet restore</code>. Instead of finding MSBuild
(which depends on your version and edition of Visual Studio) to compile my code,
I can run <code>dotnet build</code>. The CLI is the major reason why I switched back to
psake.</p><p>A &ldquo;typical&rdquo; build script for my projects will now perform these tasks:</p><ul><li>Run C# and PowerShell linters</li><li>Clean, restore and build the C# solution</li><li>Use <code>dotnet publish</code> to create binaries in a separate artifacts directory</li><li>Run unit, integration or end-to-end tests</li><li>Create and push Chocolatey packages</li></ul></article></main><footer><p>Copyright 2023, Florian Winkelbauer. All rights reserved.</p></footer></body></html>